# åŸºç¡€é•œåƒï¼šPyTorch GPU ç‰ˆï¼Œå¸¦ CUDA 12.1 + cuDNN 8
FROM pytorch/pytorch:2.3.1-cuda12.1-cudnn8-runtime

# è®¾ç½®å·¥ä½œç›®å½•
WORKDIR /app

# å®‰è£…å¿…è¦å·¥å…·
RUN apt-get update && apt-get install -y \
    git curl ffmpeg libsndfile1 && \
    rm -rf /var/lib/apt/lists/*

# å‡çº§ pip
RUN pip install --upgrade pip

# å®‰è£… Coqui TTS å’Œ Flask
RUN pip install TTS==0.22.0 flask==2.3.3

# ğŸ”’ å›ºå®š transformers ç‰ˆæœ¬ï¼Œé¿å… generate() æŠ¥é”™
RUN pip install transformers==4.41.2

# å¯é€‰ï¼šé”å®š torch/torchaudio ç‰ˆæœ¬ï¼ˆå’Œ pytorch é•œåƒä¸€è‡´ï¼‰
RUN pip install torch==2.3.1 torchaudio==2.3.1

# å¤åˆ¶æœåŠ¡ç«¯è„šæœ¬
COPY server.py /app/server.py

# æš´éœ² API ç«¯å£
EXPOSE 5000

# è¿è¡ŒæœåŠ¡
CMD ["python", "server.py"]
